{% extends "master.html" %}

{% block title %}Mark Attendance{% endblock %}

{% block content %}

<form action="" method="post">
    {% csrf_token %}
    
    <div class="d-sm-flex align-items-center justify-content-between mb-4">
        <h1 class="h3 mb-0 text-gray-800">
            <i class="fas fa-calendar-check text-primary mr-2"></i>Daily Attendance
        </h1>
        <div class="d-flex align-items-center">
            <label class="mr-2 font-weight-bold text-dark mb-0">Date:</label>
            <input type="date" name="date" class="form-control form-control-sm shadow-sm border-0 bg-white" required 
                   value="{% now 'Y-m-d' %}" style="width: 150px;">
            <button type="submit" class="btn btn-success btn-sm shadow-sm ml-3 px-4">
                <i class="fas fa-save mr-1"></i> Save Attendance
            </button>
        </div>
    </div>

    <div class="card shadow mb-4">
        <div class="card-header py-3 bg-gradient-primary text-white d-flex justify-content-between align-items-center">
            <h6 class="m-0 font-weight-bold">Class Register</h6>
            <span class="badge badge-light text-primary px-3">Total Students: {{ mymembers.count }}</span>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover mb-0 align-middle">
                    <thead class="bg-light text-dark">
                        <tr>
                            <th width="5%" class="text-center">Roll</th>
                            <th width="10%" class="text-center">Photo</th>
                            <th width="35%">Student Name</th>
                            <th width="50%" class="text-center">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for x in mymembers %}
                        <tr>
                            <td class="text-center font-weight-bold text-secondary">
                                {{ x.roll_number|default:"-" }}
                            </td>
                            <td class="text-center">
                                {% if x.profile_pic %}
                                    <img src="{{ x.profile_pic.url }}" class="rounded-circle border" width="40" height="40" style="object-fit: cover;">
                                {% else %}
                                    <div class="btn-circle btn-sm btn-secondary font-weight-bold mx-auto">
                                        {{ x.firstname|slice:":1" }}
                                    </div>
                                {% endif %}
                            </td>
                            <td>
                                <div class="font-weight-bold text-dark">{{ x.firstname }} {{ x.lastname }}</div>
                                <small class="text-muted">Class: {{ x.student_class|default:"-" }}</small>
                            </td>
                            <td class="text-center">
                                <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                    
                                    <label class="btn btn-outline-success btn-sm active" style="width: 100px;">
                                        <input type="radio" name="status_{{ x.id }}" value="Present" checked> 
                                        <i class="fas fa-check-circle"></i> Present
                                    </label>
                                    
                                    <label class="btn btn-outline-danger btn-sm" style="width: 100px;">
                                        <input type="radio" name="status_{{ x.id }}" value="Absent"> 
                                        <i class="fas fa-times-circle"></i> Absent
                                    </label>
                                    
                                    <label class="btn btn-outline-warning btn-sm text-dark" style="width: 100px;">
                                        <input type="radio" name="status_{{ x.id }}" value="Leave"> 
                                        <i class="fas fa-envelope-open"></i> Leave
                                    </label>

                                </div>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="4" class="text-center py-5 text-muted">
                                <i class="fas fa-user-graduate fa-3x mb-3 text-gray-300"></i><br>
                                No students found to mark attendance.
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</form>

{% endblock %}
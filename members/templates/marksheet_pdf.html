<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Report Card - {{ student.firstname }} {{ student.lastname }}</title>
    <style>
        @page { size: A4; margin: 1.2cm; }
        * { box-sizing: border-box; }
        body { font-family: 'Helvetica', 'Arial', sans-serif; color: #222; line-height: 1.3; font-size: 11pt; }
        
        .header { text-align: center; border-bottom: 3px solid #1e40af; padding-bottom: 12px; margin-bottom: 18px; }
        .school-name { font-size: 22pt; font-weight: bold; color: #1e3a8a; margin: 0; letter-spacing: 0.5px; }
        .school-address { font-size: 9pt; color: #64748b; margin-top: 4px; line-height: 1.4; }
        .school-meta { font-size: 9pt; color: #94a3b8; margin-top: 2px; }
        
        .report-title { background: #1e40af; color: white; padding: 10px 16px; text-align: center; font-weight: bold; font-size: 13pt; margin-bottom: 20px; }
        
        .student-info { width: 100%; margin-bottom: 22px; border-collapse: collapse; border: 1px solid #e2e8f0; }
        .student-info td { padding: 10px 12px; font-size: 10.5pt; border: 1px solid #e2e8f0; }
        .label { font-weight: 600; color: #475569; width: 22%; background: #f8fafc; }
        .value { font-weight: 600; color: #0f172a; }

        .marks-table { width: 100%; border-collapse: collapse; margin-bottom: 24px; box-shadow: 0 1px 3px rgba(0,0,0,0.06); }
        .marks-table th { background: #1e40af; color: white; border: 1px solid #1e3a8a; padding: 10px 8px; text-align: center; font-size: 9.5pt; font-weight: 600; }
        .marks-table td { border: 1px solid #e2e8f0; padding: 10px 8px; font-size: 10.5pt; }
        .marks-table tbody tr:nth-child(even) { background: #f8fafc; }
        .text-center { text-align: center; }
        .grade-cell { font-weight: 700; color: #1e40af; }
        
        .summary-box { width: 100%; border: 2px solid #1e40af; margin-top: 16px; overflow: hidden; }
        .summary-table { width: 100%; border-collapse: collapse; }
        .summary-item { padding: 16px 20px; text-align: center; border-right: 2px solid #1e40af; }
        .summary-item:last-child { border-right: none; }
        .summary-label { font-size: 8.5pt; font-weight: 700; color: #64748b; display: block; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px; }
        .summary-value { font-size: 16pt; font-weight: 700; color: #0f172a; }

        .result-pass { color: #059669 !important; font-size: 14pt; }
        .result-fail { color: #dc2626 !important; font-size: 14pt; }

        .footer { margin-top: 50px; padding-top: 20px; }
        .signature-table { width: 100%; }
        .sig-box { width: 180px; text-align: center; }
        .sig-line { border-top: 1.5px solid #334155; margin-top: 40px; margin-bottom: 6px; padding-top: 4px; }
        .sig-text { font-size: 9pt; font-weight: 600; color: #475569; }
        
        .footer-note { position: absolute; bottom: 0; left: 0; right: 0; text-align: center; font-size: 7.5pt; color: #94a3b8; border-top: 1px dashed #cbd5e1; padding-top: 6px; }
    </style>
</head>
<body>

    <div class="header">
        <div class="school-name">{{ school.name|default:"School"|upper }}</div>
        {% if school.address %}<div class="school-address">{{ school.address }}</div>{% endif %}
        <div class="school-meta">Academic Session 2025-2026 | Report Generated: {{ date|date:"d M Y" }}</div>
    </div>

    <div class="report-title">PROGRESS REPORT CARD — {{ score.exam_name|upper }}</div>

    <table class="student-info">
        <tr>
            <td class="label">Student Name</td>
            <td class="value">{{ student.firstname }} {{ student.lastname }}</td>
            <td class="label">Admission No</td>
            <td class="value">{{ student.admission_no|default:"--" }}</td>
        </tr>
        <tr>
            <td class="label">Class / Section</td>
            <td class="value">{{ student.student_class|default:"--" }}</td>
            <td class="label">Roll Number</td>
            <td class="value">{{ student.roll_number|default:"--" }}</td>
        </tr>
        <tr>
            <td class="label">Father's Name</td>
            <td class="value">{{ student.father_name|default:"--" }}</td>
            <td class="label">Examination</td>
            <td class="value">{{ score.exam_name }}</td>
        </tr>
    </table>

    <table class="marks-table">
        <thead>
            <tr>
                <th width="40%">Subject Name</th>
                <th width="20%" class="text-center">Max Marks</th>
                <th width="20%" class="text-center">Marks Obtained</th>
                <th width="20%" class="text-center">Grade</th>
            </tr>
        </thead>
        <tbody>
            {% for sub_name, marks_obtained in subject_marks_dict.items %}
            <tr>
                <td>{{ sub_name }}</td>
                <td class="text-center">100</td>
                <td class="text-center">{{ marks_obtained }}</td>
                <td class="text-center grade-cell">{% if marks_obtained >= 91 %}A1{% elif marks_obtained >= 81 %}A2{% elif marks_obtained >= 71 %}B1{% elif marks_obtained >= 61 %}B2{% elif marks_obtained >= 51 %}C1{% elif marks_obtained >= 41 %}C2{% elif marks_obtained >= 33 %}D{% else %}E{% endif %}</td>
            </tr>
            {% empty %}
            <tr><td>Mathematics</td><td class="text-center">100</td><td class="text-center">{{ score.maths }}</td><td class="text-center grade-cell">—</td></tr>
            <tr><td>Physics</td><td class="text-center">100</td><td class="text-center">{{ score.physics }}</td><td class="text-center grade-cell">—</td></tr>
            <tr><td>Chemistry</td><td class="text-center">100</td><td class="text-center">{{ score.chemistry }}</td><td class="text-center grade-cell">—</td></tr>
            <tr><td>English</td><td class="text-center">100</td><td class="text-center">{{ score.english }}</td><td class="text-center grade-cell">—</td></tr>
            <tr><td>Computer Science</td><td class="text-center">100</td><td class="text-center">{{ score.computer }}</td><td class="text-center grade-cell">—</td></tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="summary-box">
        <table class="summary-table">
            <tr>
                <td class="summary-item">
                    <span class="summary-label">Grand Total</span>
                    <span class="summary-value">{{ total_obtained }} / {{ total_max }}</span>
                </td>
                <td class="summary-item">
                    <span class="summary-label">Percentage</span>
                    <span class="summary-value">{{ percentage }}%</span>
                </td>
                <td class="summary-item">
                    <span class="summary-label">Final Result</span>
                    <span class="summary-value {% if result_status == 'PASS' %}result-pass{% else %}result-fail{% endif %}">
                        {{ result_status }}
                    </span>
                </td>
            </tr>
        </table>
    </div>

    <div class="footer">
        <table width="100%" class="signature-table">
            <tr>
                <td align="left">
                    <div class="sig-box">
                        <div class="sig-line"></div>
                        <div class="sig-text">Class Teacher</div>
                    </div>
                </td>
                <td align="center">
                    <div class="sig-box">
                        <div class="sig-line"></div>
                        <div class="sig-text">Exam Controller</div>
                    </div>
                </td>
                <td align="right">
                    <div class="sig-box">
                        <div class="sig-line"></div>
                        <div class="sig-text">Principal</div>
                    </div>
                </td>
            </tr>
        </table>
    </div>

    <div style="position: absolute; bottom: 0; width: 100%; text-align: center; font-size: 8pt; color: #999; border-top: 1px dashed #ccc; padding-top: 5px;">
        This is a computer-generated report card and does not require a physical seal/signature for online verification.
    </div>

</body>
</html>
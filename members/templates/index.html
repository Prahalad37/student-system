{% extends "master.html" %}
{% load static %}

{% block title %}Smart Dashboard{% endblock %}

{% block content %}

<div class="d-flex align-items-center justify-content-between mb-5 mt-3">
    <div>
        <h1 class="h2 mb-1 text-gray-800" style="font-weight: 700;">Overview</h1>
        <p class="text-muted mb-0" style="font-size: 0.95rem;">Here is what's happening in your institute today.</p>
    </div>
    <a href="/add" class="btn btn-primary">
        <i class="fas fa-plus fa-sm text-white mr-2"></i> Add Student
    </a>
</div>

<div class="row mb-5">
    
    <div class="col-xl-4 col-md-6 mb-4">
        <div class="card h-100 py-4 px-3">
            <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                    <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_students }}</div>
                    <div class="h2 mb-0 font-weight-bold" style="background: linear-gradient(to right, #10b981, #3b82f6); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        {{ mymembers|length }}
                    </div>
                    <p class="text-success small mt-2 mb-0 font-weight-bold">
                        <i class="fas fa-arrow-up"></i> 12% increase
                    </p>
                </div>
                <div style="width: 70px; height: 70px; border-radius: 50%; border: 6px solid #f3f4f6; border-top: 6px solid #10b981; display:flex; align-items:center; justify-content:center;">
                    <i class="fas fa-users text-gray-400"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-4 col-md-6 mb-4">
        <div class="card h-100 py-4 px-3">
            <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                    <div class="h5 mb-0 font-weight-bold text-gray-800">â‚¹ {{ total_revenue }}</div>
                    <div class="h2 mb-0 font-weight-bold" style="background: linear-gradient(to right, #3b82f6, #6366f1); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        â‚¹ 4.5L
                    </div>
                    <p class="text-success small mt-2 mb-0 font-weight-bold">
                        <i class="fas fa-arrow-up"></i> 5% this month
                    </p>
                </div>
                <div style="width: 70px; height: 70px; border-radius: 50%; border: 6px solid #f3f4f6; border-top: 6px solid #3b82f6; display:flex; align-items:center; justify-content:center;">
                    <i class="fas fa-wallet text-gray-400"></i>
                </div>
            </div>
        </div>
    </div>

     <div class="col-xl-4 col-md-6 mb-4">
        <div class="card h-100 py-4 px-3">
            <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                    <div class="text-xs font-weight-bold text-muted text-uppercase mb-2">Attendance</div>
                    <div class="row no-gutters align-items-center">
                <div class="col-auto">
        <div class="h5 mb-0 mr-3 font-weight-bold text-gray-800">{{ attendance_percent }}%</div>
    </div>
    <div class="col">
        <div class="progress progress-sm mr-2">
            <div class="progress-bar bg-info" role="progressbar" 
                 style="width: {{ attendance_percent }}%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
    </div>
</div>
                    <p class="text-muted small mt-2 mb-0">
                        Avg daily attendance
                    </p>
                </div>
                <div style="width: 70px; height: 70px; border-radius: 50%; border: 6px solid #f3f4f6; border-top: 6px solid #8b5cf6; display:flex; align-items:center; justify-content:center;">
                    <i class="fas fa-check-circle text-gray-400"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12">
        <div class="d-flex align-items-center justify-content-between mb-3 px-2">
            <h5 class="m-0 font-weight-bold text-gray-800">Recent Enrollments</h5>
            <div class="dropdown">
                <button class="btn btn-light btn-sm shadow-sm font-weight-bold" style="border-radius: 10px; color: #6b7280;">
                    <i class="fas fa-filter mr-1"></i> Filter
                </button>
            </div>
        </div>

        <div class="table-responsive">
            <div class="table-responsive">
    <table class="table table-bordered table-hover" id="dataTable" width="100%" cellspacing="0">
        <thead class="thead-light">
            <tr>
                <th>ID</th>
                <th>Student Name</th>
                <th>Class / Batch</th>
                <th>Fees Info ðŸ’°</th> <th>Status</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for x in mymembers %}
            <tr>
                <td>#{{ x.id }}</td>
                
                <td>
                    <div class="d-flex align-items-center">
                        {% if x.profile_pic %}
                            <img src="/media/{{ x.profile_pic }}" alt="Student" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;" class="mr-2">
                        
                        {% else %}
                            <div class="mr-2 d-flex justify-content-center align-items-center bg-light text-primary" style="width: 40px; height: 40px; border-radius: 50%;">
                                <i class="fas fa-user"></i>
                            </div>
                        {% endif %}
                        
                        <span class="font-weight-bold">{{ x.firstname }} {{ x.lastname }}</span>
                    </div>
                </td>

                <td>Class 12 - PCM</td>

                <td>
                    {% if x.fee_total == 0 %}
                        <span class="badge badge-secondary">Data Not Updated</span>
                    {% else %}
                        <div style="font-size: 0.9rem;">
                            <strong>Total:</strong> â‚¹{{ x.fee_total }}<br>
                           <strong class="text-danger">Due: â‚¹{{ x.due_amount }}</strong>
                        </div>
                    {% endif %}
                </td>

                <td><span class="badge badge-success">Active</span></td>

                <td>
                    <a href="update/{{ x.id }}" class="btn btn-primary btn-circle btn-sm">
                        <i class="fas fa-pen"></i>
                    </a>
                    <a href="delete/{{ x.id }}" class="btn btn-danger btn-circle btn-sm" onclick="return confirm('Are you sure?');">
                        <i class="fas fa-trash"></i>
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
            </table>
        </div>
    </div>
</div>

{% endblock %}
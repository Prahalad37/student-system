{% extends "master.html" %}
{% load static %}

{% block title %}Academic years{% endblock %}

{% block breadcrumbs %}
<nav aria-label="breadcrumb" class="mb-3">
    <ol class="breadcrumb bg-transparent py-2 mb-0">
        <li class="breadcrumb-item"><a href="{% url 'index' %}">Dashboard</a></li>
        <li class="breadcrumb-item"><a href="{% url 'school_settings' %}">School Settings</a></li>
        <li class="breadcrumb-item active">Academic years</li>
    </ol>
</nav>
{% endblock %}

{% block content %}
<div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800 font-weight-bold"><i class="fas fa-calendar-alt text-primary mr-2"></i>Academic years</h1>
    <a href="{% url 'school_settings' %}" class="btn btn-secondary"><i class="fas fa-arrow-left mr-2"></i>Back to settings</a>
</div>

<div class="row">
    <div class="col-lg-8">
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Add academic year</h6>
            </div>
            <div class="card-body">
                <form method="post" class="form-inline flex-wrap align-items-end">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="add">
                    <div class="form-group mr-2 mb-2">
                        <label class="mr-1">Name</label>
                        <input type="text" name="name" class="form-control" placeholder="e.g. 2024-25" required>
                    </div>
                    <div class="form-group mr-2 mb-2">
                        <label class="mr-1">Start date</label>
                        <input type="date" name="start_date" class="form-control" required>
                    </div>
                    <div class="form-group mr-2 mb-2">
                        <label class="mr-1">End date</label>
                        <input type="date" name="end_date" class="form-control" required>
                    </div>
                    <div class="form-group mr-2 mb-2">
                        <div class="custom-control custom-checkbox">
                            <input type="checkbox" class="custom-control-input" name="is_active" id="id_is_active" value="1">
                            <label class="custom-control-label" for="id_is_active">Set as active year</label>
                        </div>
                    </div>
                    <div class="form-group mb-2">
                        <button type="submit" class="btn btn-primary">Add</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Academic years</h6>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead class="bg-light">
                            <tr>
                                <th>Name</th>
                                <th>Start</th>
                                <th>End</th>
                                <th>Active</th>
                                <th class="text-right">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for y in years %}
                            <tr>
                                <td>{{ y.name }}</td>
                                <td>{{ y.start_date }}</td>
                                <td>{{ y.end_date }}</td>
                                <td>{% if y.is_active %}<span class="badge badge-success">Yes</span>{% else %}<span class="badge badge-secondary">No</span>{% endif %}</td>
                                <td class="text-right">
                                    <a href="{% url 'academic_year_edit' y.id %}" class="btn btn-sm btn-outline-primary">Edit</a>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="5" class="text-center py-4 text-muted">No academic years yet. Add one above.</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
